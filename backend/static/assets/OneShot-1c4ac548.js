import{r as n,b5 as e}from"./vendor-f4aa6f85.js";import{A as a,R as r,S as se,Q as oe,E as ne,a as ae,b as u,c as re,d as ie,e as le}from"./index-ff4f990e.js";import{g as ce,d as he,D as de,h as pe,T as m,e as ue,C as E,f as me}from"./fluentui-react-d3a943c3.js";import"./fluentui-icons-df61cf1f.js";const xe="_oneshotContainer_1x7b2_1",Se="_oneshotTopSection_1x7b2_15",ge="_oneshotBottomSection_1x7b2_29",Ce="_oneshotTitle_1x7b2_49",ve="_oneshotQuestionInput_1x7b2_77",Te="_oneshotAnswerContainer_1x7b2_91",fe="_oneshotAnalysisPanel_1x7b2_105",be="_oneshotSettingsSeparator_1x7b2_115",Re="_settingsButton_1x7b2_123",o={oneshotContainer:xe,oneshotTopSection:Se,oneshotBottomSection:ge,oneshotTitle:Ce,oneshotQuestionInput:ve,oneshotAnswerContainer:Te,oneshotAnalysisPanel:fe,oneshotSettingsSeparator:be,settingsButton:Re};function ye(){const[y,x]=n.useState(!1),[i,H]=n.useState(a.RetrieveThenRead),[S,D]=n.useState(""),[g,I]=n.useState(""),[C,V]=n.useState(""),[c,O]=n.useState(r.Hybrid),[_,Q]=n.useState(3),[v,U]=n.useState(!0),[A,F]=n.useState(!1),[j,L]=n.useState(""),T=n.useRef(""),[f,k]=n.useState(!1),[h,P]=n.useState(),[d,M]=n.useState(),[N,w]=n.useState(),[p,l]=n.useState(void 0),b=async t=>{T.current=t,h&&P(void 0),k(!0),w(void 0),l(void 0);try{const s={question:t,approach:i,overrides:{promptTemplate:S.length===0?void 0:S,promptTemplatePrefix:g.length===0?void 0:g,promptTemplateSuffix:C.length===0?void 0:C,excludeCategory:j.length===0?void 0:j,top:_,retrievalMode:c,semanticRanker:v,semanticCaptions:A}},B=await le(s);M(B)}catch(s){P(s)}finally{k(!1)}},q=(t,s)=>{D(s||"")},G=(t,s)=>{I(s||"")},K=(t,s)=>{V(s||"")},z=(t,s)=>{Q(parseInt(s||"1"))},J=(t,s,B)=>{O((s==null?void 0:s.data)||r.Hybrid)},W=(t,s)=>{H((s==null?void 0:s.key)||a.RetrieveThenRead)},X=(t,s)=>{U(!!s)},Y=(t,s)=>{F(!!s)},Z=(t,s)=>{L(s||"")},$=t=>{b(t)},ee=t=>{N===t&&p===u.CitationTab?l(void 0):(w(t),l(u.CitationTab))},R=t=>{l(p===t?void 0:t)},te=[{key:a.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:a.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:a.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return e.jsxs("div",{className:o.oneshotContainer,children:[e.jsxs("div",{className:o.oneshotTopSection,children:[e.jsx(se,{className:o.settingsButton,onClick:()=>x(!y)}),e.jsx("h1",{className:o.oneshotTitle,children:"Ask your data"}),e.jsx("div",{className:o.oneshotQuestionInput,children:e.jsx(oe,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:f,onSend:t=>b(t)})})]}),e.jsxs("div",{className:o.oneshotBottomSection,children:[f&&e.jsx(ce,{label:"Generating answer"}),!T.current&&e.jsx(ne,{onExampleClicked:$}),!f&&d&&!h&&e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(ae,{answer:d,onCitationClicked:t=>ee(t),onThoughtProcessClicked:()=>R(u.ThoughtProcessTab),onSupportingContentClicked:()=>R(u.SupportingContentTab)})}),h?e.jsx("div",{className:o.oneshotAnswerContainer,children:e.jsx(re,{error:h.toString(),onRetry:()=>b(T.current)})}):null,p&&d&&e.jsx(ie,{className:o.oneshotAnalysisPanel,activeCitation:N,onActiveTabChanged:t=>R(t),citationHeight:"600px",answer:d,activeTab:p})]}),e.jsxs(he,{headerText:"Configure answer generation",isOpen:y,isBlocking:!1,onDismiss:()=>x(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(de,{onClick:()=>x(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(pe,{className:o.oneshotSettingsSeparator,label:"Approach",options:te,defaultSelectedKey:i,onChange:W}),(i===a.RetrieveThenRead||i===a.ReadDecomposeAsk)&&e.jsx(m,{className:o.oneshotSettingsSeparator,defaultValue:S,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:q}),i===a.ReadRetrieveRead&&e.jsxs(e.Fragment,{children:[e.jsx(m,{className:o.oneshotSettingsSeparator,defaultValue:g,label:"Override prompt prefix template",multiline:!0,autoAdjustHeight:!0,onChange:G}),e.jsx(m,{className:o.oneshotSettingsSeparator,defaultValue:C,label:"Override prompt suffix template",multiline:!0,autoAdjustHeight:!0,onChange:K})]}),e.jsx(ue,{className:o.oneshotSettingsSeparator,label:"Retrieve this many documents from search:",min:1,max:50,defaultValue:_.toString(),onChange:z}),e.jsx(m,{className:o.oneshotSettingsSeparator,label:"Exclude category",onChange:Z}),e.jsx(E,{className:o.oneshotSettingsSeparator,checked:v,label:"Use semantic ranker for retrieval",onChange:X}),e.jsx(E,{className:o.oneshotSettingsSeparator,checked:A,label:"Use query-contextual summaries instead of whole documents",onChange:Y,disabled:!v}),e.jsx(me,{className:o.oneshotSettingsSeparator,label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:c==r.Hybrid,data:r.Hybrid},{key:"vectors",text:"Vectors",selected:c==r.Vectors,data:r.Vectors},{key:"text",text:"Text",selected:c==r.Text,data:r.Text}],required:!0,onChange:J})]})]})}ye.displayName="OneShot";export{ye as Component};
//# sourceMappingURL=OneShot-1c4ac548.js.map
